require 'bcrypt'
class SessionsController < ApplicationController
   before_action :authenticate_user, only: [:index]
  def index
  end

    def new
      id = session[:user_id]
      @user = user.find(id)
    end

    def create_session
      user = User.find_by(params[email])
    if user && user.authenticate(params[password])
      session [:user_id] = user.id
    else
      flash.now[:warning] = 'invalid email/password combination'
      render 'new'
    end

    def destroy
      user = user.find(params["id"])
      user.destroy
      redirect_to_sessions_path
    end

  private
    def authenticate_user
      unless current_user
      flash[:danger] = "Please log in."
      redirect_to_session_path
      end
    end
end